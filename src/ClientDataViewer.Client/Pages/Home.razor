@page "/"
@using ClientDataViewer.Data
@using ClientDataViewer.Data.Client
@using Microsoft.AspNetCore.Authorization

@attribute [Authorize]

<PageTitle>Auth</PageTitle>

<MudText Typo="Typo.h3" GutterBottom="true">You are authenticated</MudText>

<AuthorizeView>
    <MudText Class="mb-4">Hello @context.User.Identity?.Name!</MudText>
    <MudGrid>
        @foreach (var client in _clients)
        {
            <MudItem sm="6" lg="3" xxl="2">
                <MudCard>
                    <MudCardHeader>
                        <CardHeaderAvatar>
                            <MudAvatar Color="Color.Primary">@client.Initial</MudAvatar>
                        </CardHeaderAvatar>
                        <CardHeaderContent>
                            <MudText Typo="Typo.h6">@client.FullName</MudText>
                        </CardHeaderContent>
                    </MudCardHeader>
                    <MudCardContent>
                        <MudText  Typo="Typo.body1"><MudIcon Icon="@Icons.Material.Filled.Cake"></MudIcon> @client.BirthDateFormatted</MudText>
                    </MudCardContent>
                    <MudCardActions>
                        <MudButton StartIcon="@Icons.Material.Filled.List" Color="Color.Default">CarePlans</MudButton>
                        <MudButton StartIcon="@Icons.Material.Filled.Star" Color="Color.Default">Goals</MudButton>
                    </MudCardActions>
                </MudCard>
            </MudItem>
        }
    </MudGrid>
</AuthorizeView>

@code
{
    private readonly IClientRepository _clientRepository;
    private Client[] _clients;

    public Home(IClientRepository clientRepository)
    {
        _clientRepository = clientRepository;
        _clients = _clientRepository.Get();
    }
}